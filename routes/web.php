<?php

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/


/**************************************
** Control de Autenticaciòn JWT/AUTH ** 
***************************************/
Auth::routes();

Route::get('ldap', function () {

$usuario  = \Auth::user()->nb_usuario;
$ldapuser = \Adldap::search()
            ->select  ('cn'       , 'labeleduri')
            ->where   ('Memberuid', '=', $usuario)
            ->whereHas('labeleduri')
            ->get();
//dd($ldapuser);

});
/**************************************/

//Inicializacion Validacion JWT/AUTH
Route::middleware(['auth',])->group(function () {

#############################################################################################
################################# CONTROL DE ACCESO #########################################
#############################################################################################

Route::resource('logins' , 'Auth\LoginController@showLoginform')
    ->middleware('guest');

Route::resource('usuario', 'UsuarioController');

Route::get('/t', 'HomeController@index')
    ->name('home');

Route::get('/', 'HomeController@index')
    ->name('home');

#############################################################################################
#############################################################################################
#
#
#
#
#############################################################################################
################################# MOD OBJETIVO FUNCIONAL ####################################
#############################################################################################

Route::resource('objetivo', 'ObjetivoController');

//Ruta para obtener las gerencias que está asignadas a un proyecto
Route::get('proyecto/{proyecto}/gerencias', 'ProyectoController@gerencias')
    ->name('proyecto.gerencias');

//Ruta para obtener todas las coordinaciones que están asignadas a una gerencia
Route::get('gerencia/{gerencia}/coordinaciones', 'GerenciaController@coordinaciones')
    ->name('gerencia.coordinaciones');

//Ruta para obtener todas los objetivos que están asignadas a una coordinacion
Route::get('objetivo/coordinacion/{id_coordinacion}', 'ObjetivoController@objetivoCoordinacion');

#############################################################################################
#############################################################################################
#
#
#
#
#############################################################################################
####################################### MOD META ############################################
#############################################################################################

Route::resource('metas','MetaController');

#############################################################################################
##############################################################################################
#
#
#
#
#############################################################################################
##################################### MOD INDICADOR #########################################
#############################################################################################

Route::resource('indicadores', 'IndicadorController');

//Ruta para obtener el objetivo
Route::get('indicadores/objetivo/{id_objetivo}','IndicadoresController@indicadoresObjetivo');

#############################################################################################
#############################################################################################
#
#
#
#############################################################################################
##################################### MOD SUPUESTO ##########################################
#############################################################################################

Route::resource('supuesto', 'SupuestoController');

#############################################################################################
##############################################################################################
#
#
#
#
#############################################################################################
##################################### MOD DIRECTRIZ #########################################
#############################################################################################

Route::resource('directriz', 'DirectrizController');

//Ruta para traer el objetivo estrategico institucional
Route::get('institucional/directriz/{id_institucional}','directrizController@institucionaldirectriz');

#############################################################################################
#############################################################################################
#
#
#
#
#############################################################################################
#################################### MOD INICIATIVA #########################################
#############################################################################################

Route::resource('iniciativa', 'IniciativaController');

//Ruta para obtener el objetivo
Route::get('iniciativa/objetivo/{id_objetivo}','IniciativaController@iniciativaObjetivo');

#############################################################################################
#############################################################################################
#
#
#
#
#############################################################################################
################################# MOD SUPUESTO DE INICIATIVA ################################
#############################################################################################

Route::resource('supuestoI', 'SupuestoIController');

#############################################################################################
#############################################################################################
#
#
#
#
#############################################################################################
################################# MOD ACTIVIDAD DE INICIATIVA ###############################
#############################################################################################

Route::resource('actividad', 'ActividadController');

#############################################################################################
##############################################################################################
#
#
#
#############################################################################################
################################# MOD DICCIONARIO DE INICIATIVA #############################
#############################################################################################


Route::resource('diccionario', 'DiccionarioController');

#############################################################################################
##############################################################################################
#
#
#
#
#############################################################################################
####################################### MOD PLAN DE LA NACION ###############################
#############################################################################################


Route::resource('nacion', 'NacionController');


//Ruta para obtener todos los objetivos estratégicos de nación
Route::get('objetivo/nacion/{id_objetivo}', 'ObjetivoController@objetivoNacion');

//Ruta para obtener el plan estratégico de la nación
Route::get('iniciativa/nacion/{id_nacion}', 'NacionController@NacionIniciativa');

#############################################################################################
##############################################################################################
#
#
#
#
#############################################################################################
################################ MOD OBJETIVO ESTRATEGICO INSTITUCIONAL #####################
#############################################################################################

Route::resource('institucional', 'InstitucionalController');

//Ruta para obtener los objetivos estratégicos por medio del id de la institución
Route::get('institucional/estrategico/{id_institucional}/{id_nacion}', 'InstitucionalController@estrategicos');


//Ruta para obtener los objetivos estratégicos de la institución.
Route::get('nacion/institucional/{id_nacion}', 'NacionController@institucional');

#############################################################################################
##############################################################################################
#
#
#
#############################################################################################
################################ MOD OBJETIVO ESTRATEGICO ###################################
#############################################################################################

Route::resource('estrategico', 'EstrategicoController');

//RUTA PARA OBJETENER EL OBJETIVO ESTRATEGICO POR LA INICIATIVA
Route::get('iniciativa/estrategico/{id_estrategico}', 'IniciativaController@iniciativaEstrategico');

#############################################################################################
##############################################################################################
#
#
#
#
#############################################################################################
################################ MOD PROYECTO ###############################################
#############################################################################################

Route::resource('proyecto', 'ProyectoController');

#############################################################################################
##############################################################################################
#
#
#
#
#############################################################################################
################################ MOD GERENCIA ###############################################
#############################################################################################

Route::resource('gerencia', 'GerenciaController');

#############################################################################################
##############################################################################################
#
#
#
#
#############################################################################################
################################ MOD COORDINACION ###########################################
#############################################################################################

Route::resource('coordinacion', 'CoordinacionController');


#############################################################################################
#############################################################################################
























Route::get('user-autocomplete', 'UserController@autocomplete');

Route::resource('user', 'UserController');



Route::resource('roles','RoleController');


});



